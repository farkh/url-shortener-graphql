(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{37:function(e,t,a){e.exports=a(67)},65:function(e,t,a){},66:function(e,t,a){},67:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),l=a(32),c=a.n(l),o=a(2),u=a(9),s=a.n(u),i=a(15),m=a(33),p=a.n(m),b={authUser:null,loading:!0},f=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:b,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SET_AUTH_USER":return{authUser:t.authUser,loading:!1};default:return e}},E=Object(i.b)({sessionState:f}),d=Object(i.c)(E,Object(i.a)(p.a)),v=a(5),h=a(11),y=a(10),g=a.n(y),S=a(12),O=function(){var e=Object(S.a)(g.a.mark(function e(t){var a,n,r,l,c,o,u;return g.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!(a=localStorage.getItem("token"))){e.next=19;break}return e.prev=2,n={query:'\n                    query {\n                        verifyToken(token: "'.concat(a,'") {\n                            _id\n                            email\n                        }\n                    }\n                ')},e.next=6,s.a.post("/api",n);case 6:return r=e.sent,l=r.data,e.next=10,l.data.verifyToken;case 10:(c=e.sent)?(o=c._id,u=c.email,t({type:"SET_AUTH_USER",authUser:{_id:o,email:u}})):(t({type:"SET_AUTH_USER",authUser:null}),localStorage.removeItem("token")),e.next=17;break;case 14:e.prev=14,e.t0=e.catch(2),t({type:"SET_AUTH_USER",authUser:null});case 17:e.next=20;break;case 19:t({type:"SET_AUTH_USER",authUser:null});case 20:case"end":return e.stop()}},e,null,[[2,14]])}));return function(t){return e.apply(this,arguments)}}(),j=function(){var e=Object(o.b)();Object(n.useEffect)(function(){O(e)})},k="/",U="/login",_="/signup",x=a(17),w=function(e){var t=Object(o.b)();return r.a.createElement("div",{className:"navbar",style:e.navbarStyles},r.a.createElement("div",{className:"navbar__left"},r.a.createElement(v.b,{style:Object(x.a)({},e.linkStyles,{margin:0}),to:k},"Home")),r.a.createElement("div",{className:"navbar__right",style:{marginLeft:"auto"}},r.a.createElement(v.b,{style:e.linkStyles,onClick:function(){t({type:"SET_AUTH_USER",authUser:null}),localStorage.removeItem("token")},to:k},"Logout")))},T=function(e){return r.a.createElement("div",{className:"navbar",style:e.navbarStyles},r.a.createElement("div",{className:"navbar__left"},r.a.createElement(v.b,{style:Object(x.a)({},e.linkStyles,{margin:0}),to:k},"Home")),r.a.createElement("div",{className:"navbar__right",style:{marginLeft:"auto"}},r.a.createElement(v.b,{style:e.linkStyles,to:_},"Sign up"),r.a.createElement(v.b,{style:e.linkStyles,to:U},"Login")))},H={display:"flex",background:"#1e1e1e",padding:"20px 60px"},N={color:"#fff",textDecoration:"none",marginLeft:20},A=function(){var e=Object(n.useCallback)(function(e){return{authUser:e.sessionState.authUser}},[]);return Object(o.c)(e).authUser?r.a.createElement(w,{navbarStyles:H,linkStyles:N}):r.a.createElement(T,{navbarStyles:H,linkStyles:N})},C=function(){return r.a.createElement(r.a.Fragment,null,r.a.createElement("h1",null,"Home"),r.a.createElement("p",null,"You are logged in"))},I=function(){return r.a.createElement(r.a.Fragment,null,r.a.createElement("h1",null,"Home"),r.a.createElement("p",null,"Home for everyone"))},L=function(){var e=Object(n.useCallback)(function(e){return{authUser:e.sessionState.authUser}},[]);return Object(o.c)(e).authUser?r.a.createElement(C,null):r.a.createElement(I,null)},R=function(){return r.a.createElement("h1",null,"Oops... Page does not exist!")},q=a(8),P=Object(h.f)(function(e){var t=Object(o.b)(),a=Object(n.useState)(""),l=Object(q.a)(a,2),c=l[0],u=l[1],i=Object(n.useState)(""),m=Object(q.a)(i,2),p=m[0],b=m[1],f=Object(n.useState)(""),E=Object(q.a)(f,2),d=E[0],v=E[1],h=Object(n.useState)(null),y=Object(q.a)(h,2),O=y[0],j=y[1],U=Object(n.useState)(!1),_=Object(q.a)(U,2),x=_[0],w=_[1],T=function(e){return function(t){e(t.target.value)}},H=function(){var a=Object(S.a)(g.a.mark(function a(n){var r,l,o,u,i,m;return g.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return n&&n.preventDefault(),w(!0),r={query:'\n                mutation {\n                    createUser(userInput: {\n                        email: "'.concat(c,'"\n                        password: "').concat(p,'"\n                        confirm: "').concat(d,'"\n                    }) {\n                        _id\n                        token\n                        email\n                    }\n                }\n            ')},a.prev=3,a.next=6,s.a.post("/api",r);case 6:if(l=a.sent,!(o=l.data).errors){a.next=13;break}j(o.errors[0].message),w(!1),a.next=23;break;case 13:return a.next=15,o.data.createUser;case 15:u=a.sent,i=u._id,m=u.token,t({type:"SET_AUTH_USER",authUser:{_id:i,email:c}}),j(null),w(!1),localStorage.setItem("token",m),e.history.push(k);case 23:a.next=29;break;case 25:a.prev=25,a.t0=a.catch(3),j(a.t0),w(!1);case 29:case"end":return a.stop()}},a,null,[[3,25]])}));return function(e){return a.apply(this,arguments)}}();return r.a.createElement("div",{className:"content"},r.a.createElement("h1",null,"Sign Up"),r.a.createElement("form",{className:"form",onSubmit:H},r.a.createElement("input",{type:"text",name:"email",placeholder:"Email",value:c,onChange:T(u)}),r.a.createElement("input",{type:"password",name:"password",placeholder:"Password",value:p,onChange:T(b)}),r.a.createElement("input",{type:"password",name:"confirm",placeholder:"Confirm password",value:d,onChange:T(v)}),r.a.createElement("div",null,r.a.createElement("span",{style:{color:"red"}},O||"")),r.a.createElement("input",{type:"submit",value:x?"Verifying...":"Sign Up"})))}),D=Object(h.f)(function(e){var t=Object(o.b)(),a=Object(n.useState)(""),l=Object(q.a)(a,2),c=l[0],u=l[1],i=Object(n.useState)(""),m=Object(q.a)(i,2),p=m[0],b=m[1],f=Object(n.useState)(null),E=Object(q.a)(f,2),d=E[0],v=E[1],h=Object(n.useState)(!1),y=Object(q.a)(h,2),O=y[0],j=y[1],U=function(e){return function(t){e(t.target.value)}},_=function(){var a=Object(S.a)(g.a.mark(function a(n){var r,l,o,u,i,m;return g.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return n&&n.preventDefault(),j(!0),a.prev=2,r={query:'\n                    query {\n                        login(email: "'.concat(c,'", password: "').concat(p,'") {\n                            _id\n                            token\n                            email\n                        }\n                    }\n                ')},a.next=6,s.a.post("/api",r);case 6:l=a.sent,(o=l.data).errors?(j(!1),v(o.errors[0].message)):(u=o.data.login,i=u._id,m=u.token,t({type:"SET_AUTH_USER",authUser:{_id:i,email:c}}),j(!1),v(null),localStorage.setItem("token",m),e.history.push(k)),a.next=15;break;case 11:a.prev=11,a.t0=a.catch(2),v(a.t0),j(!1);case 15:case"end":return a.stop()}},a,null,[[2,11]])}));return function(e){return a.apply(this,arguments)}}();return r.a.createElement("div",{className:"content"},r.a.createElement("h1",null,"Login"),r.a.createElement("form",{className:"form",onSubmit:_},r.a.createElement("input",{type:"text",name:"email",placeholder:"Email",value:c,onChange:U(u)}),r.a.createElement("input",{type:"password",name:"password",placeholder:"Password",value:p,onChange:U(b)}),r.a.createElement("div",null,r.a.createElement("span",{style:{color:"red"}},d||"")),r.a.createElement("input",{type:"submit",value:O?"Verifying...":"Login"})))});a(65);var F=function(){j();var e=Object(n.useCallback)(function(e){return{loading:e.sessionState.loading}},[]);return Object(o.c)(e).loading?r.a.createElement("h1",null,"Loading..."):r.a.createElement(v.a,{basename:""},r.a.createElement("div",{className:"App"},r.a.createElement(A,null),r.a.createElement(h.c,null,r.a.createElement(h.a,{exact:!0,path:k,component:function(){return r.a.createElement(L,null)}}),r.a.createElement(h.a,{exact:!0,path:_,component:function(){return r.a.createElement(P,null)}}),r.a.createElement(h.a,{exact:!0,path:U,component:function(){return r.a.createElement(D,null)}}),r.a.createElement(h.a,{component:R}))))};a(66);!function(){var e=localStorage.getItem("token");s.a.defaults.headers.common.Authorization=e||null}(),c.a.render(r.a.createElement(o.a.Provider,{value:d},r.a.createElement(F,null)),document.getElementById("root"))}},[[37,1,2]]]);
//# sourceMappingURL=main.2b6bd023.chunk.js.map